
var sample = (function(){
    
    var DEVICE1 = {
        sentence: '$KIPYO,DEVICE1,SENTENCE1',
        logs: [
            '$KIPYO,DEVICE1,SENTENCE1',
            '$KIPYO,DEVICE1,SENTENCE2',
            '$KIPYO,DEVICE1,SENTENCE3',
            '$KIPYO,DEVICE1,SENTENCE4'
        ]
    };
    
    var DEVICE2 = {
        sentence: '$KIPYO,DEVICE2,SENTENCE1',
        logs: [
            '$KIPYO,DEVICE2,SENTENCE1',
            '$KIPYO,DEVICE2,SENTENCE2',
            '$KIPYO,DEVICE2,SENTENCE3',
            '$KIPYO,DEVICE2,SENTENCE4'
        ]
    };
    
    var DEVICE3 = {
        sentence: '$KIPYO,DEVICE3,SENTENCE1',
        logs: [
            '$KIPYO,DEVICE3,SENTENCE1',
            '$KIPYO,DEVICE3,SENTENCE2',
            '$KIPYO,DEVICE3,SENTENCE3',
            '$KIPYO,DEVICE3,SENTENCE4'
        ]
    };
    
    
    
    
    var client;
    var sampleRedis = {};
    
    
    sampleRedis.init = function(redis){
        client = redis;
        
        client.hset('REALTIME', 'DEVICE1', JSON.stringify(DEVICE1), client.print);
        client.hset('REALTIME', 'DEVICE2', JSON.stringify(DEVICE2), client.print);
        client.hset('REALTIME', 'DEVICE3', JSON.stringify(DEVICE3), client.print);
        
    }
    
    sampleRedis.update = function(id, sentence){
        if(!client) throw new Error('Redis client not initialized');
        
        client.hget(id, function(err, result){
            if(err) throw err;
            
            // Get
            var device = JSON.parse(result);
            device.logs.push(sentence);
            
            // Set
            client.hset(id, device.stringify(device));
            
            
        });
    }
    
    
    return sampleRedis;
}());

module.exports = sample;